<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>唐诗宋词高频探索 - 管理员后台</title>
    <link rel="stylesheet" href="../css/admin.css">
    <style>
        /* 基础样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }

        body {
            background: #f5f5f5;
            color: #333;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* 侧边栏样式 */
        .sidebar {
            width: 250px;
            background: #30323d;
            color: #fff;
            padding: 20px 0;
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #3e4151;
        }

        .sidebar-menu {
            margin-top: 20px;
        }

        .menu-item {
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }

        .menu-item:hover {
            background: #3e4151;
        }

        .menu-item.active {
            background: #4a5064;
            border-left: 4px solid #f7b731;
        }

        .menu-item i {
            margin-right: 10px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        /* 主内容区域样式 */
        .main-content {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
            margin-bottom: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
        }

        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }

        /* 内容模块样式 */
        .content-section {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 20px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            margin-bottom: 15px;
        }

        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .card {
            background: #fafafa;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .card-title {
            font-size: 18px;
            margin-bottom: 10px;
            color: #30323d;
        }

        .card-value {
            font-size: 28px;
            font-weight: bold;
            color: #f7b731;
        }

        /* 表格样式 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th, .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background-color: #f9f9f9;
            font-weight: 600;
        }

        .data-table tr:hover {
            background-color: #f5f5f5;
        }

        .action-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 5px;
            font-size: 14px;
        }

        .edit-btn {
            background: #3498db;
            color: white;
        }

        .delete-btn {
            background: #e74c3c;
            color: white;
        }

        .search-bar {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 15px;
            width: 100%;
            max-width: 400px;
        }

        /* 表单样式 */
        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        /* 隐藏所有页面内容块 */
        .page-content {
            display: none;
        }

        /* 显示活动页面 */
        .page-content.active {
            display: block;
        }

        /* 添加新的样式 */
        .category-card {
            background: #fff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            text-align: center;
            position: relative;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .category-card h3 {
            margin-bottom: 10px;
            color: #30323d;
        }

        .category-actions {
            margin-top: 15px;
        }

        .add-card {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            background: #f8f9fa;
            border: 2px dashed #ddd;
        }

        .add-icon {
            font-size: 32px;
            color: #aaa;
            margin-bottom: 10px;
        }

        .tag-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .tag-name {
            font-weight: 500;
            flex-grow: 1;
        }

        .tag-count {
            background: #e9ecef;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 14px;
            margin: 0 15px;
        }

        .tag-actions {
            display: flex;
            gap: 5px;
        }

        .tags-container {
            margin-top: 20px;
        }

        .tag-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 5px;
        }

        .tag-checkbox {
            padding: 5px 10px;
            background: #f0f0f0;
            border-radius: 4px;
            cursor: pointer;
        }

        .import-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .import-card {
            background: #fff;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            text-align: center;
            transition: all 0.3s;
        }

        .import-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .import-icon {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .template-options {
            margin-top: 15px;
        }

        .template-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .template-icon {
            margin-right: 10px;
            font-size: 18px;
        }

        .template-name {
            flex-grow: 1;
        }

        .status-success {
            color: #28a745;
            font-weight: 500;
        }

        .status-error {
            color: #dc3545;
            font-weight: 500;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 14px;
            background: #e9ecef;
            color: #495057;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .btn-sm:hover {
            background: #dee2e6;
        }
    </style>
</head>

<body>
    <div class="admin-container">
        <!-- 侧边栏 -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>管理员后台</h2>
                <p>唐诗宋词高频探索系统</p>
            </div>
            <div class="sidebar-menu">
                <div class="menu-item active" data-page="dashboard">
                    <i>📊</i> 仪表盘
                </div>
                <div class="menu-item" data-page="users">
                    <i>👥</i> 用户管理
                </div>
                <div class="menu-item" data-page="poems">
                    <i>📚</i> 诗词管理
                </div>
                <div class="menu-item" data-page="poets">
                    <i>✍️</i> 诗人管理
                </div>
                <div class="menu-item" data-page="categories">
                    <i>📋</i> 分类管理
                </div>
                <div class="menu-item" data-page="tags">
                    <i>🏷️</i> 主题标签
                </div>
                <div class="menu-item" data-page="data-import">
                    <i>📥</i> 数据导入
                </div>
                <div class="menu-item" data-page="analysis">
                    <i>📈</i> 数据分析
                </div>
                <div class="menu-item" data-page="settings">
                    <i>⚙️</i> 系统设置
                </div>
                <div class="menu-item" id="logoutBtn">
                    <i>🚪</i> 退出登录
                </div>
            </div>
        </div>

        <!-- 主内容区域 -->
        <div class="main-content">
            <div class="content-header">
                <h1 id="page-title">仪表盘</h1>
                <div class="user-info">
                    <img src="../img/touxiang1.jpg" alt="管理员头像">
                    <span id="admin-name">管理员</span>
                </div>
            </div>

            <!-- 仪表盘页面 -->
            <div class="page-content active" id="dashboard-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>系统概况</h2>
                        <span>最近更新: 今天</span>
                    </div>
                    <div class="card-container">
                        <div class="card">
                            <div class="card-title">注册用户</div>
                            <div class="card-value">128</div>
                        </div>
                        <div class="card">
                            <div class="card-title">诗词总数</div>
                            <div class="card-value">5,241</div>
                        </div>
                        <div class="card">
                            <div class="card-title">今日访问</div>
                            <div class="card-value">328</div>
                        </div>
                        <div class="card">
                            <div class="card-title">数据更新</div>
                            <div class="card-value">98%</div>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <div class="section-header">
                        <h2>最近活动</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>用户</th>
                                <th>活动</th>
                                <th>时间</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>user123</td>
                                <td>登录系统</td>
                                <td>10分钟前</td>
                            </tr>
                            <tr>
                                <td>poem_lover</td>
                                <td>查询高频词</td>
                                <td>25分钟前</td>
                            </tr>
                            <tr>
                                <td>admin</td>
                                <td>添加新诗词</td>
                                <td>1小时前</td>
                            </tr>
                            <tr>
                                <td>scholar01</td>
                                <td>注册账号</td>
                                <td>2小时前</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 用户管理页面 -->
            <div class="page-content" id="users-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>用户列表</h2>
                        <input type="text" class="search-bar" placeholder="搜索用户...">
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>用户名</th>
                                <th>用户类型</th>
                                <th>注册时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>admin</td>
                                <td>管理员</td>
                                <td>2023-05-15</td>
                                <td>
                                    <button class="action-btn edit-btn">编辑</button>
                                </td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>user123</td>
                                <td>普通用户</td>
                                <td>2023-06-20</td>
                                <td>
                                    <button class="action-btn edit-btn">编辑</button>
                                    <button class="action-btn delete-btn">删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>poem_lover</td>
                                <td>普通用户</td>
                                <td>2023-07-08</td>
                                <td>
                                    <button class="action-btn edit-btn">编辑</button>
                                    <button class="action-btn delete-btn">删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>scholar01</td>
                                <td>普通用户</td>
                                <td>2023-08-17</td>
                                <td>
                                    <button class="action-btn edit-btn">编辑</button>
                                    <button class="action-btn delete-btn">删除</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>添加/编辑用户</h2>
                    </div>
                    <form id="user-form">
                        <div class="form-group">
                            <label for="username">用户名</label>
                            <input type="text" id="username" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="password">密码</label>
                            <input type="password" id="password" class="form-control" placeholder="留空表示不修改密码">
                        </div>
                        <div class="form-group">
                            <label for="userType">用户类型</label>
                            <select id="userType" class="form-control">
                                <option value="user">普通用户</option>
                                <option value="admin">管理员</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">保存</button>
                    </form>
                </div>
            </div>

            <!-- 诗词管理页面 -->
            <div class="page-content" id="poems-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>诗词列表</h2>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="poem-search" class="search-bar" placeholder="搜索诗词...">
                            <button class="btn btn-primary" id="add-poem-btn">添加诗词</button>
                        </div>
                    </div>
                    <div style="margin-bottom: 15px; color: #666;">
                        <p>系统共有<span id="total-poems-count">--</span>首诗词，每页显示10首。使用搜索框可以查询特定诗词。</p>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>标题</th>
                                <th>作者</th>
                                <th>朝代</th>
                                <th>类别</th>
                                <th>主题</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="poems-list">
                            <!-- 诗词数据将通过JavaScript动态加载 -->
                            <tr>
                                <td colspan="7" style="text-align: center;">正在加载诗词数据...</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="pagination" id="poems-pagination" style="margin-top: 20px; display: flex; justify-content: center;">
                        <button class="btn btn-sm" id="prev-page">上一页</button>
                        <span id="page-info" style="margin: 0 15px; line-height: 30px;">第 1 页</span>
                        <button class="btn btn-sm" id="next-page">下一页</button>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2 id="poem-form-title">添加诗词</h2>
                    </div>
                    <form id="poem-form">
                        <input type="hidden" id="poem-id">
                        <div class="form-group">
                            <label for="title">标题</label>
                            <input type="text" id="title" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="author">作者</label>
                            <input type="text" id="author" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="dynasty">朝代</label>
                            <select id="dynasty" class="form-control">
                                <option value="唐">唐</option>
                                <option value="宋">宋</option>
                                <option value="其他">其他</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="category">类别</label>
                            <select id="category" class="form-control">
                                <option value="五言绝句">五言绝句</option>
                                <option value="七言绝句">七言绝句</option>
                                <option value="五言律诗">五言律诗</option>
                                <option value="七言律诗">七言律诗</option>
                                <option value="词">词</option>
                                <option value="浪淘沙">浪淘沙</option>
                                <option value="瑞鹤仙">瑞鹤仙</option>
                                <option value="霜天晓角">霜天晓角</option>
                                <option value="其他">其他</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="theme">主题</label>
                            <select id="theme" class="form-control">
                                <option value="">选择主题</option>
                                <option value="思乡">思乡</option>
                                <option value="忧国">忧国</option>
                                <option value="送别">送别</option>
                                <option value="抒情">抒情</option>
                                <option value="咏物">咏物</option>
                                <option value="怀古">怀古</option>
                                <option value="边塞">边塞</option>
                                <option value="其他">其他</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="content">内容</label>
                            <textarea id="content" class="form-control" rows="6" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="tags">标签</label>
                            <input type="text" id="tags" class="form-control" placeholder="多个标签用逗号分隔">
                            <small class="form-text text-muted">例如: 思乡,抒情,送别</small>
                        </div>
                        <div class="form-actions" style="display: flex; gap: 10px;">
                            <button type="submit" class="btn btn-primary">保存</button>
                            <button type="button" id="cancel-edit" class="btn">取消</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- 新增诗人管理页面 -->
            <div class="page-content" id="poets-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>诗人列表</h2>
                        <input type="text" class="search-bar" placeholder="搜索诗人...">
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>姓名</th>
                                <th>朝代</th>
                                <th>生卒年</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>李白</td>
                                <td>唐</td>
                                <td>701-762</td>
                                <td>
                                    <button class="action-btn edit-btn">编辑</button>
                                    <button class="action-btn delete-btn">删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>杜甫</td>
                                <td>唐</td>
                                <td>712-770</td>
                                <td>
                                    <button class="action-btn edit-btn">编辑</button>
                                    <button class="action-btn delete-btn">删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>苏轼</td>
                                <td>宋</td>
                                <td>1037-1101</td>
                                <td>
                                    <button class="action-btn edit-btn">编辑</button>
                                    <button class="action-btn delete-btn">删除</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>添加/编辑诗人</h2>
                    </div>
                    <form id="poet-form">
                        <div class="form-group">
                            <label for="poet-name">姓名</label>
                            <input type="text" id="poet-name" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="poet-dynasty">朝代</label>
                            <select id="poet-dynasty" class="form-control">
                                <option value="唐">唐</option>
                                <option value="宋">宋</option>
                                <option value="其他">其他</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="poet-birth">出生年</label>
                            <input type="number" id="poet-birth" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="poet-death">逝世年</label>
                            <input type="number" id="poet-death" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="poet-desc">简介</label>
                            <textarea id="poet-desc" class="form-control" rows="4"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">保存</button>
                    </form>
                </div>
            </div>

            <!-- 分类管理页面 -->
            <div class="page-content" id="categories-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>诗词分类</h2>
                    </div>
                    <div class="card-container">
                        <div class="category-card">
                            <h3>五言绝句</h3>
                            <p>收录数量: 247</p>
                            <div class="category-actions">
                                <button class="btn btn-sm">编辑</button>
                                <button class="btn btn-sm">查看</button>
                            </div>
                        </div>
                        <div class="category-card">
                            <h3>七言绝句</h3>
                            <p>收录数量: 315</p>
                            <div class="category-actions">
                                <button class="btn btn-sm">编辑</button>
                                <button class="btn btn-sm">查看</button>
                            </div>
                        </div>
                        <div class="category-card">
                            <h3>律诗</h3>
                            <p>收录数量: 182</p>
                            <div class="category-actions">
                                <button class="btn btn-sm">编辑</button>
                                <button class="btn btn-sm">查看</button>
                            </div>
                        </div>
                        <div class="category-card">
                            <h3>词</h3>
                            <p>收录数量: 426</p>
                            <div class="category-actions">
                                <button class="btn btn-sm">编辑</button>
                                <button class="btn btn-sm">查看</button>
                            </div>
                        </div>
                        <div class="category-card add-card">
                            <div class="add-icon">+</div>
                            <p>添加新分类</p>
                        </div>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>分类详情设置</h2>
                    </div>
                    <form id="category-form">
                        <div class="form-group">
                            <label for="category-name">分类名称</label>
                            <input type="text" id="category-name" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="category-desc">分类描述</label>
                            <textarea id="category-desc" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="category-rules">分类规则</label>
                            <textarea id="category-rules" class="form-control" rows="3" placeholder="例如：五言绝句 - 每首诗有4行，每行5个字"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">保存分类</button>
                    </form>
                </div>
            </div>

            <!-- 主题标签页面 -->
            <div class="page-content" id="tags-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>主题标签管理</h2>
                        <button class="btn btn-primary">添加新标签</button>
                    </div>
                    <div class="tags-container">
                        <div class="tag-item">
                            <span class="tag-name">思乡</span>
                            <span class="tag-count">134</span>
                            <div class="tag-actions">
                                <button class="action-btn edit-btn">编辑</button>
                                <button class="action-btn delete-btn">删除</button>
                            </div>
                        </div>
                        <div class="tag-item">
                            <span class="tag-name">忧国</span>
                            <span class="tag-count">98</span>
                            <div class="tag-actions">
                                <button class="action-btn edit-btn">编辑</button>
                                <button class="action-btn delete-btn">删除</button>
                            </div>
                        </div>
                        <div class="tag-item">
                            <span class="tag-name">抒情</span>
                            <span class="tag-count">256</span>
                            <div class="tag-actions">
                                <button class="action-btn edit-btn">编辑</button>
                                <button class="action-btn delete-btn">删除</button>
                            </div>
                        </div>
                        <div class="tag-item">
                            <span class="tag-name">怀古</span>
                            <span class="tag-count">87</span>
                            <div class="tag-actions">
                                <button class="action-btn edit-btn">编辑</button>
                                <button class="action-btn delete-btn">删除</button>
                            </div>
                        </div>
                        <div class="tag-item">
                            <span class="tag-name">送别</span>
                            <span class="tag-count">112</span>
                            <div class="tag-actions">
                                <button class="action-btn edit-btn">编辑</button>
                                <button class="action-btn delete-btn">删除</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>批量标签管理</h2>
                    </div>
                    <form id="batch-tag-form">
                        <div class="form-group">
                            <label>选择操作</label>
                            <select class="form-control">
                                <option>批量添加标签</option>
                                <option>批量删除标签</option>
                                <option>合并标签</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>选择诗词</label>
                            <select class="form-control" multiple size="5">
                                <option>静夜思 - 李白</option>
                                <option>登高 - 杜甫</option>
                                <option>水调歌头 - 苏轼</option>
                                <option>春望 - 杜甫</option>
                                <option>长相思 - 苏轼</option>
                            </select>
                            <small class="form-text text-muted">按住Ctrl键可多选</small>
                        </div>
                        <div class="form-group">
                            <label>选择标签</label>
                            <div class="tag-selector">
                                <label class="tag-checkbox"><input type="checkbox"> 思乡</label>
                                <label class="tag-checkbox"><input type="checkbox"> 忧国</label>
                                <label class="tag-checkbox"><input type="checkbox"> 抒情</label>
                                <label class="tag-checkbox"><input type="checkbox"> 怀古</label>
                                <label class="tag-checkbox"><input type="checkbox"> 送别</label>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">应用</button>
                    </form>
                </div>
            </div>

            <!-- 数据导入页面 -->
            <div class="page-content" id="data-import-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>批量数据导入</h2>
                    </div>
                    <div class="import-options">
                        <div class="import-card">
                            <div class="import-icon">📄</div>
                            <h3>导入诗词数据</h3>
                            <p>从Excel或CSV文件导入诗词</p>
                            <button class="btn btn-primary">选择文件</button>
                        </div>
                        <div class="import-card">
                            <div class="import-icon">👤</div>
                            <h3>导入诗人数据</h3>
                            <p>从Excel或CSV文件导入诗人信息</p>
                            <button class="btn btn-primary">选择文件</button>
                        </div>
                        <div class="import-card">
                            <div class="import-icon">🔄</div>
                            <h3>更新现有数据</h3>
                            <p>更新已有诗词或诗人信息</p>
                            <button class="btn btn-primary">选择文件</button>
                        </div>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>导入模板</h2>
                    </div>
                    <div class="template-options">
                        <div class="template-item">
                            <i class="template-icon">📥</i>
                            <span class="template-name">诗词导入模板</span>
                            <button class="btn btn-sm">下载</button>
                        </div>
                        <div class="template-item">
                            <i class="template-icon">📥</i>
                            <span class="template-name">诗人导入模板</span>
                            <button class="btn btn-sm">下载</button>
                        </div>
                        <div class="template-item">
                            <i class="template-icon">📥</i>
                            <span class="template-name">高频词导入模板</span>
                            <button class="btn btn-sm">下载</button>
                        </div>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>导入历史</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>导入时间</th>
                                <th>数据类型</th>
                                <th>文件名</th>
                                <th>数据量</th>
                                <th>状态</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2023-10-15 15:30</td>
                                <td>诗词数据</td>
                                <td>tang_poems_batch1.xlsx</td>
                                <td>124条</td>
                                <td><span class="status-success">成功</span></td>
                            </tr>
                            <tr>
                                <td>2023-10-12 09:45</td>
                                <td>诗人数据</td>
                                <td>song_poets.csv</td>
                                <td>42条</td>
                                <td><span class="status-success">成功</span></td>
                            </tr>
                            <tr>
                                <td>2023-10-05 14:20</td>
                                <td>高频词数据</td>
                                <td>frequency_words.xlsx</td>
                                <td>518条</td>
                                <td><span class="status-error">部分失败</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 数据分析页面 -->
            <div class="page-content" id="analysis-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>访问统计</h2>
                    </div>
                    <div style="height: 300px; background-color: #f9f9f9; display: flex; justify-content: center; align-items: center;">
                        <p>访问量统计图表 - 需要集成图表库</p>
                    </div>
                </div>
                
                <div class="content-section">
                    <div class="section-header">
                        <h2>热门诗词排行</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>排名</th>
                                <th>诗词</th>
                                <th>作者</th>
                                <th>访问次数</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>静夜思</td>
                                <td>李白</td>
                                <td>1,258</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>将进酒</td>
                                <td>李白</td>
                                <td>952</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>水调歌头</td>
                                <td>苏轼</td>
                                <td>867</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>蜀道难</td>
                                <td>李白</td>
                                <td>743</td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>登高</td>
                                <td>杜甫</td>
                                <td>621</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 系统设置页面 -->
            <div class="page-content" id="settings-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>基本设置</h2>
                    </div>
                    <form id="settings-form">
                        <div class="form-group">
                            <label for="site-title">网站标题</label>
                            <input type="text" id="site-title" class="form-control" value="数据视角下的唐诗宋词高频探索">
                        </div>
                        <div class="form-group">
                            <label for="site-description">网站描述</label>
                            <textarea id="site-description" class="form-control" rows="3">基于数据分析的唐诗宋词研究平台，通过可视化展示唐诗宋词的高频词汇、诗人社会网络和诗词数据统计</textarea>
                        </div>
                        <div class="form-group">
                            <label for="contact-email">联系邮箱</label>
                            <input type="email" id="contact-email" class="form-control" value="mjy127890@qq.com">
                        </div>
                        <button type="submit" class="btn btn-primary">保存设置</button>
                    </form>
                </div>
                
                <div class="content-section">
                    <div class="section-header">
                        <h2>数据库备份</h2>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <p>最近备份时间: 2023-10-15 08:30:42</p>
                    </div>
                    <button class="btn btn-primary">立即备份</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let currentPage = 1;
        const pageSize = 10; // 每页显示10条数据
        let totalPoems = 0;
        let totalPages = 0;
        const API_BASE_URL = 'http://localhost:3000/api';
        let editMode = false;
        
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化菜单切换
            initMenuToggle();
            
            // 加载诗词数据
            loadPoems();
            
            // 绑定搜索框事件
            document.getElementById('poem-search').addEventListener('keyup', debounce(searchPoems, 500));
            
            // 绑定添加诗词按钮事件
            document.getElementById('add-poem-btn').addEventListener('click', showAddPoemForm);
            
            // 绑定诗词表单提交事件
            document.getElementById('poem-form').addEventListener('submit', savePoemData);
            
            // 绑定取消编辑按钮事件
            document.getElementById('cancel-edit').addEventListener('click', resetPoemForm);
            
            // 绑定分页按钮事件
            document.getElementById('prev-page').addEventListener('click', function() {
                changePage(-1);
            });
            
            document.getElementById('next-page').addEventListener('click', function() {
                changePage(1);
            });
            
            // 绑定退出登录按钮事件
            document.getElementById('logoutBtn').addEventListener('click', function() {
                localStorage.removeItem('token');
                window.location.href = './登录.html';
            });
            
            // 其他表单提交事件
            const forms = document.querySelectorAll('form:not(#poem-form)');
            forms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    alert('表单提交成功！');
                    this.reset();
                });
            });
        });

        // 加载诗词数据
        async function loadPoems(searchTerm = '') {
            const poemsListElem = document.getElementById('poems-list');
            poemsListElem.innerHTML = '<tr><td colspan="7" style="text-align: center;">正在加载诗词数据...</td></tr>';
            
            try {
                // 构建请求URL
                let url = `${API_BASE_URL}/poems?page=${currentPage}&limit=${pageSize}`;
                if (searchTerm) {
                    url += `&title=${encodeURIComponent(searchTerm)}`;
                }
                
                // 获取 token
                const token = localStorage.getItem('token');
                if (!token) {
                    throw new Error('未登录或会话已过期');
                }
                
                // 获取总记录数
                const countResponse = await fetch(`${API_BASE_URL}/poems?page=1&limit=1`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!countResponse.ok) {
                    throw new Error('获取诗词总数失败');
                }
                
                const countData = await countResponse.json();
                // 根据API返回格式获取总记录数
                if (countData && countData.length > 0 && countData[0].total_count) {
                    totalPoems = countData[0].total_count;
                } else {
                    // 如果API没有返回总数，先尝试从响应头获取
                    const totalHeader = countResponse.headers.get('X-Total-Count');
                    if (totalHeader) {
                        totalPoems = parseInt(totalHeader);
                    } else {
                        // 如果都没有，则进行一次不分页的查询来估算总数
                        const allResponse = await fetch(`${API_BASE_URL}/poems?limit=2500`, {
                            headers: {
                                'Authorization': `Bearer ${token}`
                            }
                        });
                        if (allResponse.ok) {
                            const allData = await allResponse.json();
                            totalPoems = allData.length;
                        } else {
                            totalPoems = 100; // 默认值
                        }
                    }
                }
                
                totalPages = Math.ceil(totalPoems / pageSize);
                console.log(`总记录数: ${totalPoems}, 总页数: ${totalPages}`);
                
                // 发送请求获取当前页数据
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error('获取诗词数据失败');
                }
                
                const poems = await response.json();
                
                // 更新分页信息
                updatePagination();
                
                // 清空诗词列表
                poemsListElem.innerHTML = '';
                
                // 如果没有诗词数据
                if (poems.length === 0) {
                    poemsListElem.innerHTML = '<tr><td colspan="7" style="text-align: center;">暂无诗词数据</td></tr>';
                    return;
                }
                
                // 填充诗词数据
                poems.forEach(poem => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${poem.id}</td>
                        <td>${poem.title || ''}</td>
                        <td>${poem.author || ''}</td>
                        <td>${poem.dynasty || ''}</td>
                        <td>${poem.category || ''}</td>
                        <td>${poem.theme || ''}</td>
                        <td>
                            <button class="action-btn edit-btn" data-id="${poem.id}">编辑</button>
                            <button class="action-btn delete-btn" data-id="${poem.id}">删除</button>
                        </td>
                    `;
                    poemsListElem.appendChild(row);
                });
                
                // 绑定编辑和删除按钮事件
                bindPoemActions();
            } catch (error) {
                console.error('加载诗词失败:', error);
                poemsListElem.innerHTML = `<tr><td colspan="7" style="text-align: center;">加载失败: ${error.message}</td></tr>`;
            }
        }
        
        // 更新分页信息
        function updatePagination() {
            const pageInfo = document.getElementById('page-info');
            pageInfo.textContent = `第 ${currentPage} 页 / 共 ${totalPages} 页 (共${totalPoems}首诗词)`;
            
            // 更新分页按钮状态
            document.getElementById('prev-page').disabled = currentPage <= 1;
            document.getElementById('next-page').disabled = currentPage >= totalPages;
            
            // 更新诗词计数
            document.getElementById('total-poems-count').textContent = totalPoems;
        }
        
        // 切换页码
        function changePage(delta) {
            const newPage = currentPage + delta;
            if (newPage < 1) return;
            
            const totalPages = Math.ceil(totalPoems / pageSize);
            if (newPage > totalPages) return;
            
            currentPage = newPage;
            loadPoems(document.getElementById('poem-search').value);
        }
        
        // 搜索诗词
        function searchPoems() {
            const searchTerm = document.getElementById('poem-search').value;
            currentPage = 1; // 重置到第一页
            loadPoems(searchTerm);
        }
        
        // 绑定诗词操作按钮事件
        function bindPoemActions() {
            // 绑定编辑按钮
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const poemId = this.getAttribute('data-id');
                    editPoem(poemId);
                });
            });
            
            // 绑定删除按钮
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const poemId = this.getAttribute('data-id');
                    deletePoem(poemId);
                });
            });
        }
        
        // 编辑诗词
        async function editPoem(poemId) {
            try {
                // 获取 token
                const token = localStorage.getItem('token');
                if (!token) {
                    throw new Error('未登录或会话已过期');
                }
                
                // 发送请求获取诗词详情
                const response = await fetch(`${API_BASE_URL}/poems/${poemId}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error('获取诗词详情失败');
                }
                
                const data = await response.json();
                const poem = data.data || data;
                
                // 填充表单数据
                document.getElementById('poem-id').value = poem.id;
                document.getElementById('title').value = poem.title || '';
                document.getElementById('author').value = poem.author || '';
                document.getElementById('dynasty').value = poem.dynasty || '唐';
                document.getElementById('content').value = poem.content || '';
                document.getElementById('category').value = poem.category || '其他';
                document.getElementById('theme').value = poem.theme || '';
                document.getElementById('tags').value = poem.tags ? poem.tags.join(',') : '';
                
                // 更新表单标题
                document.getElementById('poem-form-title').textContent = '编辑诗词';
                
                // 进入编辑模式
                editMode = true;
                
                // 滚动到表单位置
                document.getElementById('poem-form').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('编辑诗词失败:', error);
                alert(`编辑诗词失败: ${error.message}`);
            }
        }
        
        // 删除诗词
        async function deletePoem(poemId) {
            if (!confirm('确定要删除该诗词吗？此操作不可恢复！')) {
                return;
            }
            
            try {
                // 获取 token
                const token = localStorage.getItem('token');
                if (!token) {
                    throw new Error('未登录或会话已过期');
                }
                
                // 发送删除请求
                const response = await fetch(`${API_BASE_URL}/poems/${poemId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error('删除诗词失败');
                }
                
                alert('删除诗词成功');
                
                // 重新加载诗词列表
                loadPoems();
            } catch (error) {
                console.error('删除诗词失败:', error);
                alert(`删除诗词失败: ${error.message}`);
            }
        }
        
        // 显示添加诗词表单
        function showAddPoemForm() {
            // 重置表单
            resetPoemForm();
            
            // 更新表单标题
            document.getElementById('poem-form-title').textContent = '添加诗词';
            
            // 滚动到表单位置
            document.getElementById('poem-form').scrollIntoView({ behavior: 'smooth' });
        }
        
        // 重置诗词表单
        function resetPoemForm() {
            document.getElementById('poem-form').reset();
            document.getElementById('poem-id').value = '';
            document.getElementById('poem-form-title').textContent = '添加诗词';
            editMode = false;
        }
        
        // 保存诗词数据
        async function savePoemData(event) {
            event.preventDefault();
            
            try {
                // 获取表单数据
                const poemId = document.getElementById('poem-id').value;
                const title = document.getElementById('title').value;
                const author = document.getElementById('author').value;
                const dynasty = document.getElementById('dynasty').value;
                const content = document.getElementById('content').value;
                const category = document.getElementById('category').value;
                const theme = document.getElementById('theme').value;
                const tagsString = document.getElementById('tags').value;
                const tags = tagsString ? tagsString.split(',').map(tag => tag.trim()) : [];
                
                // 验证必填字段
                if (!title || !author || !dynasty || !content) {
                    alert('请填写必填字段：标题、作者、朝代和内容');
                    return;
                }
                
                // 获取 token
                const token = localStorage.getItem('token');
                if (!token) {
                    throw new Error('未登录或会话已过期');
                }
                
                // 准备请求数据
                const requestData = {
                    title,
                    author,
                    dynasty,
                    content,
                    category,
                    theme,
                    tags
                };
                
                let url = `${API_BASE_URL}/poems`;
                let method = 'POST';
                
                // 如果是编辑模式
                if (editMode && poemId) {
                    url = `${API_BASE_URL}/poems/${poemId}`;
                    method = 'PUT';
                }
                
                // 发送请求
                const response = await fetch(url, {
                    method,
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(requestData)
                });
                
                if (!response.ok) {
                    throw new Error(`${editMode ? '更新' : '添加'}诗词失败`);
                }
                
                alert(`${editMode ? '更新' : '添加'}诗词成功`);
                
                // 重置表单
                resetPoemForm();
                
                // 重新加载诗词列表
                loadPoems();
            } catch (error) {
                console.error('保存诗词失败:', error);
                alert(`保存诗词失败: ${error.message}`);
            }
        }
        
        // 防抖函数
        function debounce(func, delay) {
            let timeout;
            return function() {
                const context = this;
                const args = arguments;
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(context, args), delay);
            };
        }

        // 初始化菜单切换功能
        function initMenuToggle() {
            // 获取用户信息
            const userData = JSON.parse(localStorage.getItem('user')) || {};
            if (userData.username) {
                document.getElementById('admin-name').textContent = userData.username;
            }
            
            // 验证是否是管理员
            checkAdminAuth();
            
            // 菜单切换功能
            const menuItems = document.querySelectorAll('.menu-item');
            const pageContents = document.querySelectorAll('.page-content');
            const pageTitle = document.getElementById('page-title');
            
            menuItems.forEach(item => {
                if (!item.id || item.id !== 'logoutBtn') {
                    item.addEventListener('click', function() {
                        // 更新活动菜单项
                        menuItems.forEach(mi => mi.classList.remove('active'));
                        this.classList.add('active');
                        
                        // 更新页面标题
                        pageTitle.textContent = this.textContent.trim();
                        
                        // 显示对应内容区域
                        const targetPage = this.getAttribute('data-page');
                        pageContents.forEach(page => {
                            page.classList.remove('active');
                            if (page.id === `${targetPage}-page`) {
                                page.classList.add('active');
                                
                                // 如果切换到诗词管理页面，重新加载诗词数据
                                if (targetPage === 'poems') {
                                    loadPoems();
                                }
                            }
                        });
                    });
                }
            });
            
            // 为分类卡片添加点击事件
            document.querySelectorAll('.add-card').forEach(card => {
                card.addEventListener('click', function() {
                    document.getElementById('category-form').reset();
                    document.getElementById('category-name').focus();
                });
            });
            
            // 为导入卡片添加点击事件
            document.querySelectorAll('.import-card button').forEach(button => {
                button.addEventListener('click', function() {
                    alert('此功能将打开文件选择对话框，选择数据文件进行导入。');
                });
            });
            
            // 为模板下载按钮添加点击事件
            document.querySelectorAll('.template-item button').forEach(button => {
                button.addEventListener('click', function() {
                    const templateName = this.parentElement.querySelector('.template-name').textContent;
                    alert(`将下载${templateName}，实际应用中会触发文件下载。`);
                });
            });
            
            // 批量标签表单提交
            document.getElementById('batch-tag-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                alert('批量标签操作提交成功！');
            });
        }
        
        // 验证管理员权限
        function checkAdminAuth() {
            const token = localStorage.getItem('token');
            const user = JSON.parse(localStorage.getItem('user')) || {};
            
            if (!token || user.userType !== 'admin') {
                alert('您没有管理员权限，将返回登录页面');
                window.location.href = './登录.html';
            }
        }
    </script>
</body>

</html> 