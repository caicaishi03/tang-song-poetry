<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å”è¯—å®‹è¯é«˜é¢‘æ¢ç´¢ - ç®¡ç†å‘˜åå°</title>
    <link rel="stylesheet" href="../css/admin.css">
    <style>
        /* åŸºç¡€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }

        body {
            background: #f5f5f5;
            color: #333;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* ä¾§è¾¹æ æ ·å¼ */
        .sidebar {
            width: 250px;
            background: #30323d;
            color: #fff;
            padding: 20px 0;
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #3e4151;
        }

        .sidebar-menu {
            margin-top: 20px;
        }

        .menu-item {
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }

        .menu-item:hover {
            background: #3e4151;
        }

        .menu-item.active {
            background: #4a5064;
            border-left: 4px solid #f7b731;
        }

        .menu-item i {
            margin-right: 10px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        /* ä¸»å†…å®¹åŒºåŸŸæ ·å¼ */
        .main-content {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
            margin-bottom: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
        }

        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }

        /* å†…å®¹æ¨¡å—æ ·å¼ */
        .content-section {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 20px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            margin-bottom: 15px;
        }

        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .card {
            background: #fafafa;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .card-title {
            font-size: 18px;
            margin-bottom: 10px;
            color: #30323d;
        }

        .card-value {
            font-size: 28px;
            font-weight: bold;
            color: #f7b731;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th, .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background-color: #f9f9f9;
            font-weight: 600;
        }

        .data-table tr:hover {
            background-color: #f5f5f5;
        }

        .action-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 5px;
            font-size: 14px;
        }

        .edit-btn {
            background: #3498db;
            color: white;
        }

        .delete-btn {
            background: #e74c3c;
            color: white;
        }

        .search-bar {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 15px;
            width: 100%;
            max-width: 400px;
        }

        /* è¡¨å•æ ·å¼ */
        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        /* éšè—æ‰€æœ‰é¡µé¢å†…å®¹å— */
        .page-content {
            display: none;
        }

        /* æ˜¾ç¤ºæ´»åŠ¨é¡µé¢ */
        .page-content.active {
            display: block;
        }

        /* æ·»åŠ æ–°çš„æ ·å¼ */
        .category-card {
            background: #fff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            text-align: center;
            position: relative;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .category-card h3 {
            margin-bottom: 10px;
            color: #30323d;
        }

        .category-actions {
            margin-top: 15px;
        }

        .add-card {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            background: #f8f9fa;
            border: 2px dashed #ddd;
        }

        .add-icon {
            font-size: 32px;
            color: #aaa;
            margin-bottom: 10px;
        }

        .tag-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .tag-name {
            font-weight: 500;
            flex-grow: 1;
        }

        .tag-count {
            background: #e9ecef;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 14px;
            margin: 0 15px;
        }

        .tag-actions {
            display: flex;
            gap: 5px;
        }

        .tags-container {
            margin-top: 20px;
        }

        .tag-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 5px;
        }

        .tag-checkbox {
            padding: 5px 10px;
            background: #f0f0f0;
            border-radius: 4px;
            cursor: pointer;
        }

        .import-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .import-card {
            background: #fff;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            text-align: center;
            transition: all 0.3s;
        }

        .import-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .import-icon {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .template-options {
            margin-top: 15px;
        }

        .template-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .template-icon {
            margin-right: 10px;
            font-size: 18px;
        }

        .template-name {
            flex-grow: 1;
        }

        .status-success {
            color: #28a745;
            font-weight: 500;
        }

        .status-error {
            color: #dc3545;
            font-weight: 500;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 14px;
            background: #e9ecef;
            color: #495057;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .btn-sm:hover {
            background: #dee2e6;
        }
    </style>
</head>

<body>
    <div class="admin-container">
        <!-- ä¾§è¾¹æ  -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>ç®¡ç†å‘˜åå°</h2>
                <p>å”è¯—å®‹è¯é«˜é¢‘æ¢ç´¢ç³»ç»Ÿ</p>
            </div>
            <div class="sidebar-menu">
                <div class="menu-item active" data-page="dashboard">
                    <i>ğŸ“Š</i> ä»ªè¡¨ç›˜
                </div>
                <div class="menu-item" data-page="users">
                    <i>ğŸ‘¥</i> ç”¨æˆ·ç®¡ç†
                </div>
                <div class="menu-item" data-page="poems">
                    <i>ğŸ“š</i> è¯—è¯ç®¡ç†
                </div>
                <div class="menu-item" data-page="poets">
                    <i>âœï¸</i> è¯—äººç®¡ç†
                </div>
                <div class="menu-item" data-page="categories">
                    <i>ğŸ“‹</i> åˆ†ç±»ç®¡ç†
                </div>
                <div class="menu-item" data-page="tags">
                    <i>ğŸ·ï¸</i> ä¸»é¢˜æ ‡ç­¾
                </div>
                <div class="menu-item" data-page="data-import">
                    <i>ğŸ“¥</i> æ•°æ®å¯¼å…¥
                </div>
                <div class="menu-item" data-page="analysis">
                    <i>ğŸ“ˆ</i> æ•°æ®åˆ†æ
                </div>
                <div class="menu-item" data-page="settings">
                    <i>âš™ï¸</i> ç³»ç»Ÿè®¾ç½®
                </div>
                <div class="menu-item" id="logoutBtn">
                    <i>ğŸšª</i> é€€å‡ºç™»å½•
                </div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <div class="content-header">
                <h1 id="page-title">ä»ªè¡¨ç›˜</h1>
                <div class="user-info">
                    <img src="../img/touxiang1.jpg" alt="ç®¡ç†å‘˜å¤´åƒ">
                    <span id="admin-name">ç®¡ç†å‘˜</span>
                </div>
            </div>

            <!-- ä»ªè¡¨ç›˜é¡µé¢ -->
            <div class="page-content active" id="dashboard-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>ç³»ç»Ÿæ¦‚å†µ</h2>
                        <span>æœ€è¿‘æ›´æ–°: ä»Šå¤©</span>
                    </div>
                    <div class="card-container">
                        <div class="card">
                            <div class="card-title">æ³¨å†Œç”¨æˆ·</div>
                            <div class="card-value">128</div>
                        </div>
                        <div class="card">
                            <div class="card-title">è¯—è¯æ€»æ•°</div>
                            <div class="card-value">5,241</div>
                        </div>
                        <div class="card">
                            <div class="card-title">ä»Šæ—¥è®¿é—®</div>
                            <div class="card-value">328</div>
                        </div>
                        <div class="card">
                            <div class="card-title">æ•°æ®æ›´æ–°</div>
                            <div class="card-value">98%</div>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <div class="section-header">
                        <h2>æœ€è¿‘æ´»åŠ¨</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ç”¨æˆ·</th>
                                <th>æ´»åŠ¨</th>
                                <th>æ—¶é—´</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>user123</td>
                                <td>ç™»å½•ç³»ç»Ÿ</td>
                                <td>10åˆ†é’Ÿå‰</td>
                            </tr>
                            <tr>
                                <td>poem_lover</td>
                                <td>æŸ¥è¯¢é«˜é¢‘è¯</td>
                                <td>25åˆ†é’Ÿå‰</td>
                            </tr>
                            <tr>
                                <td>admin</td>
                                <td>æ·»åŠ æ–°è¯—è¯</td>
                                <td>1å°æ—¶å‰</td>
                            </tr>
                            <tr>
                                <td>scholar01</td>
                                <td>æ³¨å†Œè´¦å·</td>
                                <td>2å°æ—¶å‰</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ç”¨æˆ·ç®¡ç†é¡µé¢ -->
            <div class="page-content" id="users-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>ç”¨æˆ·åˆ—è¡¨</h2>
                        <input type="text" class="search-bar" placeholder="æœç´¢ç”¨æˆ·...">
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ç”¨æˆ·å</th>
                                <th>ç”¨æˆ·ç±»å‹</th>
                                <th>æ³¨å†Œæ—¶é—´</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>admin</td>
                                <td>ç®¡ç†å‘˜</td>
                                <td>2023-05-15</td>
                                <td>
                                    <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                </td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>user123</td>
                                <td>æ™®é€šç”¨æˆ·</td>
                                <td>2023-06-20</td>
                                <td>
                                    <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                    <button class="action-btn delete-btn">åˆ é™¤</button>
                                </td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>poem_lover</td>
                                <td>æ™®é€šç”¨æˆ·</td>
                                <td>2023-07-08</td>
                                <td>
                                    <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                    <button class="action-btn delete-btn">åˆ é™¤</button>
                                </td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>scholar01</td>
                                <td>æ™®é€šç”¨æˆ·</td>
                                <td>2023-08-17</td>
                                <td>
                                    <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                    <button class="action-btn delete-btn">åˆ é™¤</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>æ·»åŠ /ç¼–è¾‘ç”¨æˆ·</h2>
                    </div>
                    <form id="user-form">
                        <div class="form-group">
                            <label for="username">ç”¨æˆ·å</label>
                            <input type="text" id="username" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="password">å¯†ç </label>
                            <input type="password" id="password" class="form-control" placeholder="ç•™ç©ºè¡¨ç¤ºä¸ä¿®æ”¹å¯†ç ">
                        </div>
                        <div class="form-group">
                            <label for="userType">ç”¨æˆ·ç±»å‹</label>
                            <select id="userType" class="form-control">
                                <option value="user">æ™®é€šç”¨æˆ·</option>
                                <option value="admin">ç®¡ç†å‘˜</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                    </form>
                </div>
            </div>

            <!-- è¯—è¯ç®¡ç†é¡µé¢ -->
            <div class="page-content" id="poems-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>è¯—è¯åˆ—è¡¨</h2>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="poem-search" class="search-bar" placeholder="æœç´¢è¯—è¯...">
                            <button class="btn btn-primary" id="add-poem-btn">æ·»åŠ è¯—è¯</button>
                        </div>
                    </div>
                    <div style="margin-bottom: 15px; color: #666;">
                        <p>ç³»ç»Ÿå…±æœ‰<span id="total-poems-count">--</span>é¦–è¯—è¯ï¼Œæ¯é¡µæ˜¾ç¤º10é¦–ã€‚ä½¿ç”¨æœç´¢æ¡†å¯ä»¥æŸ¥è¯¢ç‰¹å®šè¯—è¯ã€‚</p>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>æ ‡é¢˜</th>
                                <th>ä½œè€…</th>
                                <th>æœä»£</th>
                                <th>ç±»åˆ«</th>
                                <th>ä¸»é¢˜</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="poems-list">
                            <!-- è¯—è¯æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                            <tr>
                                <td colspan="7" style="text-align: center;">æ­£åœ¨åŠ è½½è¯—è¯æ•°æ®...</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="pagination" id="poems-pagination" style="margin-top: 20px; display: flex; justify-content: center;">
                        <button class="btn btn-sm" id="prev-page">ä¸Šä¸€é¡µ</button>
                        <span id="page-info" style="margin: 0 15px; line-height: 30px;">ç¬¬ 1 é¡µ</span>
                        <button class="btn btn-sm" id="next-page">ä¸‹ä¸€é¡µ</button>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2 id="poem-form-title">æ·»åŠ è¯—è¯</h2>
                    </div>
                    <form id="poem-form">
                        <input type="hidden" id="poem-id">
                        <div class="form-group">
                            <label for="title">æ ‡é¢˜</label>
                            <input type="text" id="title" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="author">ä½œè€…</label>
                            <input type="text" id="author" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="dynasty">æœä»£</label>
                            <select id="dynasty" class="form-control">
                                <option value="å”">å”</option>
                                <option value="å®‹">å®‹</option>
                                <option value="å…¶ä»–">å…¶ä»–</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="category">ç±»åˆ«</label>
                            <select id="category" class="form-control">
                                <option value="äº”è¨€ç»å¥">äº”è¨€ç»å¥</option>
                                <option value="ä¸ƒè¨€ç»å¥">ä¸ƒè¨€ç»å¥</option>
                                <option value="äº”è¨€å¾‹è¯—">äº”è¨€å¾‹è¯—</option>
                                <option value="ä¸ƒè¨€å¾‹è¯—">ä¸ƒè¨€å¾‹è¯—</option>
                                <option value="è¯">è¯</option>
                                <option value="æµªæ·˜æ²™">æµªæ·˜æ²™</option>
                                <option value="ç‘é¹¤ä»™">ç‘é¹¤ä»™</option>
                                <option value="éœœå¤©æ™“è§’">éœœå¤©æ™“è§’</option>
                                <option value="å…¶ä»–">å…¶ä»–</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="theme">ä¸»é¢˜</label>
                            <select id="theme" class="form-control">
                                <option value="">é€‰æ‹©ä¸»é¢˜</option>
                                <option value="æ€ä¹¡">æ€ä¹¡</option>
                                <option value="å¿§å›½">å¿§å›½</option>
                                <option value="é€åˆ«">é€åˆ«</option>
                                <option value="æŠ’æƒ…">æŠ’æƒ…</option>
                                <option value="å’ç‰©">å’ç‰©</option>
                                <option value="æ€€å¤">æ€€å¤</option>
                                <option value="è¾¹å¡">è¾¹å¡</option>
                                <option value="å…¶ä»–">å…¶ä»–</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="content">å†…å®¹</label>
                            <textarea id="content" class="form-control" rows="6" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="tags">æ ‡ç­¾</label>
                            <input type="text" id="tags" class="form-control" placeholder="å¤šä¸ªæ ‡ç­¾ç”¨é€—å·åˆ†éš”">
                            <small class="form-text text-muted">ä¾‹å¦‚: æ€ä¹¡,æŠ’æƒ…,é€åˆ«</small>
                        </div>
                        <div class="form-actions" style="display: flex; gap: 10px;">
                            <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                            <button type="button" id="cancel-edit" class="btn">å–æ¶ˆ</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- æ–°å¢è¯—äººç®¡ç†é¡µé¢ -->
            <div class="page-content" id="poets-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>è¯—äººåˆ—è¡¨</h2>
                        <input type="text" class="search-bar" placeholder="æœç´¢è¯—äºº...">
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>å§“å</th>
                                <th>æœä»£</th>
                                <th>ç”Ÿå’å¹´</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>æç™½</td>
                                <td>å”</td>
                                <td>701-762</td>
                                <td>
                                    <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                    <button class="action-btn delete-btn">åˆ é™¤</button>
                                </td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>æœç”«</td>
                                <td>å”</td>
                                <td>712-770</td>
                                <td>
                                    <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                    <button class="action-btn delete-btn">åˆ é™¤</button>
                                </td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>è‹è½¼</td>
                                <td>å®‹</td>
                                <td>1037-1101</td>
                                <td>
                                    <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                    <button class="action-btn delete-btn">åˆ é™¤</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>æ·»åŠ /ç¼–è¾‘è¯—äºº</h2>
                    </div>
                    <form id="poet-form">
                        <div class="form-group">
                            <label for="poet-name">å§“å</label>
                            <input type="text" id="poet-name" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="poet-dynasty">æœä»£</label>
                            <select id="poet-dynasty" class="form-control">
                                <option value="å”">å”</option>
                                <option value="å®‹">å®‹</option>
                                <option value="å…¶ä»–">å…¶ä»–</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="poet-birth">å‡ºç”Ÿå¹´</label>
                            <input type="number" id="poet-birth" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="poet-death">é€ä¸–å¹´</label>
                            <input type="number" id="poet-death" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="poet-desc">ç®€ä»‹</label>
                            <textarea id="poet-desc" class="form-control" rows="4"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                    </form>
                </div>
            </div>

            <!-- åˆ†ç±»ç®¡ç†é¡µé¢ -->
            <div class="page-content" id="categories-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>è¯—è¯åˆ†ç±»</h2>
                    </div>
                    <div class="card-container">
                        <div class="category-card">
                            <h3>äº”è¨€ç»å¥</h3>
                            <p>æ”¶å½•æ•°é‡: 247</p>
                            <div class="category-actions">
                                <button class="btn btn-sm">ç¼–è¾‘</button>
                                <button class="btn btn-sm">æŸ¥çœ‹</button>
                            </div>
                        </div>
                        <div class="category-card">
                            <h3>ä¸ƒè¨€ç»å¥</h3>
                            <p>æ”¶å½•æ•°é‡: 315</p>
                            <div class="category-actions">
                                <button class="btn btn-sm">ç¼–è¾‘</button>
                                <button class="btn btn-sm">æŸ¥çœ‹</button>
                            </div>
                        </div>
                        <div class="category-card">
                            <h3>å¾‹è¯—</h3>
                            <p>æ”¶å½•æ•°é‡: 182</p>
                            <div class="category-actions">
                                <button class="btn btn-sm">ç¼–è¾‘</button>
                                <button class="btn btn-sm">æŸ¥çœ‹</button>
                            </div>
                        </div>
                        <div class="category-card">
                            <h3>è¯</h3>
                            <p>æ”¶å½•æ•°é‡: 426</p>
                            <div class="category-actions">
                                <button class="btn btn-sm">ç¼–è¾‘</button>
                                <button class="btn btn-sm">æŸ¥çœ‹</button>
                            </div>
                        </div>
                        <div class="category-card add-card">
                            <div class="add-icon">+</div>
                            <p>æ·»åŠ æ–°åˆ†ç±»</p>
                        </div>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>åˆ†ç±»è¯¦æƒ…è®¾ç½®</h2>
                    </div>
                    <form id="category-form">
                        <div class="form-group">
                            <label for="category-name">åˆ†ç±»åç§°</label>
                            <input type="text" id="category-name" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="category-desc">åˆ†ç±»æè¿°</label>
                            <textarea id="category-desc" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="category-rules">åˆ†ç±»è§„åˆ™</label>
                            <textarea id="category-rules" class="form-control" rows="3" placeholder="ä¾‹å¦‚ï¼šäº”è¨€ç»å¥ - æ¯é¦–è¯—æœ‰4è¡Œï¼Œæ¯è¡Œ5ä¸ªå­—"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">ä¿å­˜åˆ†ç±»</button>
                    </form>
                </div>
            </div>

            <!-- ä¸»é¢˜æ ‡ç­¾é¡µé¢ -->
            <div class="page-content" id="tags-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>ä¸»é¢˜æ ‡ç­¾ç®¡ç†</h2>
                        <button class="btn btn-primary">æ·»åŠ æ–°æ ‡ç­¾</button>
                    </div>
                    <div class="tags-container">
                        <div class="tag-item">
                            <span class="tag-name">æ€ä¹¡</span>
                            <span class="tag-count">134</span>
                            <div class="tag-actions">
                                <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                <button class="action-btn delete-btn">åˆ é™¤</button>
                            </div>
                        </div>
                        <div class="tag-item">
                            <span class="tag-name">å¿§å›½</span>
                            <span class="tag-count">98</span>
                            <div class="tag-actions">
                                <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                <button class="action-btn delete-btn">åˆ é™¤</button>
                            </div>
                        </div>
                        <div class="tag-item">
                            <span class="tag-name">æŠ’æƒ…</span>
                            <span class="tag-count">256</span>
                            <div class="tag-actions">
                                <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                <button class="action-btn delete-btn">åˆ é™¤</button>
                            </div>
                        </div>
                        <div class="tag-item">
                            <span class="tag-name">æ€€å¤</span>
                            <span class="tag-count">87</span>
                            <div class="tag-actions">
                                <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                <button class="action-btn delete-btn">åˆ é™¤</button>
                            </div>
                        </div>
                        <div class="tag-item">
                            <span class="tag-name">é€åˆ«</span>
                            <span class="tag-count">112</span>
                            <div class="tag-actions">
                                <button class="action-btn edit-btn">ç¼–è¾‘</button>
                                <button class="action-btn delete-btn">åˆ é™¤</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>æ‰¹é‡æ ‡ç­¾ç®¡ç†</h2>
                    </div>
                    <form id="batch-tag-form">
                        <div class="form-group">
                            <label>é€‰æ‹©æ“ä½œ</label>
                            <select class="form-control">
                                <option>æ‰¹é‡æ·»åŠ æ ‡ç­¾</option>
                                <option>æ‰¹é‡åˆ é™¤æ ‡ç­¾</option>
                                <option>åˆå¹¶æ ‡ç­¾</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>é€‰æ‹©è¯—è¯</label>
                            <select class="form-control" multiple size="5">
                                <option>é™å¤œæ€ - æç™½</option>
                                <option>ç™»é«˜ - æœç”«</option>
                                <option>æ°´è°ƒæ­Œå¤´ - è‹è½¼</option>
                                <option>æ˜¥æœ› - æœç”«</option>
                                <option>é•¿ç›¸æ€ - è‹è½¼</option>
                            </select>
                            <small class="form-text text-muted">æŒ‰ä½Ctrlé”®å¯å¤šé€‰</small>
                        </div>
                        <div class="form-group">
                            <label>é€‰æ‹©æ ‡ç­¾</label>
                            <div class="tag-selector">
                                <label class="tag-checkbox"><input type="checkbox"> æ€ä¹¡</label>
                                <label class="tag-checkbox"><input type="checkbox"> å¿§å›½</label>
                                <label class="tag-checkbox"><input type="checkbox"> æŠ’æƒ…</label>
                                <label class="tag-checkbox"><input type="checkbox"> æ€€å¤</label>
                                <label class="tag-checkbox"><input type="checkbox"> é€åˆ«</label>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">åº”ç”¨</button>
                    </form>
                </div>
            </div>

            <!-- æ•°æ®å¯¼å…¥é¡µé¢ -->
            <div class="page-content" id="data-import-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>æ‰¹é‡æ•°æ®å¯¼å…¥</h2>
                    </div>
                    <div class="import-options">
                        <div class="import-card">
                            <div class="import-icon">ğŸ“„</div>
                            <h3>å¯¼å…¥è¯—è¯æ•°æ®</h3>
                            <p>ä»Excelæˆ–CSVæ–‡ä»¶å¯¼å…¥è¯—è¯</p>
                            <button class="btn btn-primary">é€‰æ‹©æ–‡ä»¶</button>
                        </div>
                        <div class="import-card">
                            <div class="import-icon">ğŸ‘¤</div>
                            <h3>å¯¼å…¥è¯—äººæ•°æ®</h3>
                            <p>ä»Excelæˆ–CSVæ–‡ä»¶å¯¼å…¥è¯—äººä¿¡æ¯</p>
                            <button class="btn btn-primary">é€‰æ‹©æ–‡ä»¶</button>
                        </div>
                        <div class="import-card">
                            <div class="import-icon">ğŸ”„</div>
                            <h3>æ›´æ–°ç°æœ‰æ•°æ®</h3>
                            <p>æ›´æ–°å·²æœ‰è¯—è¯æˆ–è¯—äººä¿¡æ¯</p>
                            <button class="btn btn-primary">é€‰æ‹©æ–‡ä»¶</button>
                        </div>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>å¯¼å…¥æ¨¡æ¿</h2>
                    </div>
                    <div class="template-options">
                        <div class="template-item">
                            <i class="template-icon">ğŸ“¥</i>
                            <span class="template-name">è¯—è¯å¯¼å…¥æ¨¡æ¿</span>
                            <button class="btn btn-sm">ä¸‹è½½</button>
                        </div>
                        <div class="template-item">
                            <i class="template-icon">ğŸ“¥</i>
                            <span class="template-name">è¯—äººå¯¼å…¥æ¨¡æ¿</span>
                            <button class="btn btn-sm">ä¸‹è½½</button>
                        </div>
                        <div class="template-item">
                            <i class="template-icon">ğŸ“¥</i>
                            <span class="template-name">é«˜é¢‘è¯å¯¼å…¥æ¨¡æ¿</span>
                            <button class="btn btn-sm">ä¸‹è½½</button>
                        </div>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2>å¯¼å…¥å†å²</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>å¯¼å…¥æ—¶é—´</th>
                                <th>æ•°æ®ç±»å‹</th>
                                <th>æ–‡ä»¶å</th>
                                <th>æ•°æ®é‡</th>
                                <th>çŠ¶æ€</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2023-10-15 15:30</td>
                                <td>è¯—è¯æ•°æ®</td>
                                <td>tang_poems_batch1.xlsx</td>
                                <td>124æ¡</td>
                                <td><span class="status-success">æˆåŠŸ</span></td>
                            </tr>
                            <tr>
                                <td>2023-10-12 09:45</td>
                                <td>è¯—äººæ•°æ®</td>
                                <td>song_poets.csv</td>
                                <td>42æ¡</td>
                                <td><span class="status-success">æˆåŠŸ</span></td>
                            </tr>
                            <tr>
                                <td>2023-10-05 14:20</td>
                                <td>é«˜é¢‘è¯æ•°æ®</td>
                                <td>frequency_words.xlsx</td>
                                <td>518æ¡</td>
                                <td><span class="status-error">éƒ¨åˆ†å¤±è´¥</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- æ•°æ®åˆ†æé¡µé¢ -->
            <div class="page-content" id="analysis-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>è®¿é—®ç»Ÿè®¡</h2>
                    </div>
                    <div style="height: 300px; background-color: #f9f9f9; display: flex; justify-content: center; align-items: center;">
                        <p>è®¿é—®é‡ç»Ÿè®¡å›¾è¡¨ - éœ€è¦é›†æˆå›¾è¡¨åº“</p>
                    </div>
                </div>
                
                <div class="content-section">
                    <div class="section-header">
                        <h2>çƒ­é—¨è¯—è¯æ’è¡Œ</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>æ’å</th>
                                <th>è¯—è¯</th>
                                <th>ä½œè€…</th>
                                <th>è®¿é—®æ¬¡æ•°</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>é™å¤œæ€</td>
                                <td>æç™½</td>
                                <td>1,258</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>å°†è¿›é…’</td>
                                <td>æç™½</td>
                                <td>952</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>æ°´è°ƒæ­Œå¤´</td>
                                <td>è‹è½¼</td>
                                <td>867</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>èœ€é“éš¾</td>
                                <td>æç™½</td>
                                <td>743</td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>ç™»é«˜</td>
                                <td>æœç”«</td>
                                <td>621</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ç³»ç»Ÿè®¾ç½®é¡µé¢ -->
            <div class="page-content" id="settings-page">
                <div class="content-section">
                    <div class="section-header">
                        <h2>åŸºæœ¬è®¾ç½®</h2>
                    </div>
                    <form id="settings-form">
                        <div class="form-group">
                            <label for="site-title">ç½‘ç«™æ ‡é¢˜</label>
                            <input type="text" id="site-title" class="form-control" value="æ•°æ®è§†è§’ä¸‹çš„å”è¯—å®‹è¯é«˜é¢‘æ¢ç´¢">
                        </div>
                        <div class="form-group">
                            <label for="site-description">ç½‘ç«™æè¿°</label>
                            <textarea id="site-description" class="form-control" rows="3">åŸºäºæ•°æ®åˆ†æçš„å”è¯—å®‹è¯ç ”ç©¶å¹³å°ï¼Œé€šè¿‡å¯è§†åŒ–å±•ç¤ºå”è¯—å®‹è¯çš„é«˜é¢‘è¯æ±‡ã€è¯—äººç¤¾ä¼šç½‘ç»œå’Œè¯—è¯æ•°æ®ç»Ÿè®¡</textarea>
                        </div>
                        <div class="form-group">
                            <label for="contact-email">è”ç³»é‚®ç®±</label>
                            <input type="email" id="contact-email" class="form-control" value="mjy127890@qq.com">
                        </div>
                        <button type="submit" class="btn btn-primary">ä¿å­˜è®¾ç½®</button>
                    </form>
                </div>
                
                <div class="content-section">
                    <div class="section-header">
                        <h2>æ•°æ®åº“å¤‡ä»½</h2>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <p>æœ€è¿‘å¤‡ä»½æ—¶é—´: 2023-10-15 08:30:42</p>
                    </div>
                    <button class="btn btn-primary">ç«‹å³å¤‡ä»½</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentPage = 1;
        const pageSize = 10; // æ¯é¡µæ˜¾ç¤º10æ¡æ•°æ®
        let totalPoems = 0;
        let totalPages = 0;
        const API_BASE_URL = 'http://localhost:3000/api';
        let editMode = false;
        
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–èœå•åˆ‡æ¢
            initMenuToggle();
            
            // åŠ è½½è¯—è¯æ•°æ®
            loadPoems();
            
            // ç»‘å®šæœç´¢æ¡†äº‹ä»¶
            document.getElementById('poem-search').addEventListener('keyup', debounce(searchPoems, 500));
            
            // ç»‘å®šæ·»åŠ è¯—è¯æŒ‰é’®äº‹ä»¶
            document.getElementById('add-poem-btn').addEventListener('click', showAddPoemForm);
            
            // ç»‘å®šè¯—è¯è¡¨å•æäº¤äº‹ä»¶
            document.getElementById('poem-form').addEventListener('submit', savePoemData);
            
            // ç»‘å®šå–æ¶ˆç¼–è¾‘æŒ‰é’®äº‹ä»¶
            document.getElementById('cancel-edit').addEventListener('click', resetPoemForm);
            
            // ç»‘å®šåˆ†é¡µæŒ‰é’®äº‹ä»¶
            document.getElementById('prev-page').addEventListener('click', function() {
                changePage(-1);
            });
            
            document.getElementById('next-page').addEventListener('click', function() {
                changePage(1);
            });
            
            // ç»‘å®šé€€å‡ºç™»å½•æŒ‰é’®äº‹ä»¶
            document.getElementById('logoutBtn').addEventListener('click', function() {
                localStorage.removeItem('token');
                window.location.href = './ç™»å½•.html';
            });
            
            // å…¶ä»–è¡¨å•æäº¤äº‹ä»¶
            const forms = document.querySelectorAll('form:not(#poem-form)');
            forms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    alert('è¡¨å•æäº¤æˆåŠŸï¼');
                    this.reset();
                });
            });
        });

        // åŠ è½½è¯—è¯æ•°æ®
        async function loadPoems(searchTerm = '') {
            const poemsListElem = document.getElementById('poems-list');
            poemsListElem.innerHTML = '<tr><td colspan="7" style="text-align: center;">æ­£åœ¨åŠ è½½è¯—è¯æ•°æ®...</td></tr>';
            
            try {
                // æ„å»ºè¯·æ±‚URL
                let url = `${API_BASE_URL}/poems?page=${currentPage}&limit=${pageSize}`;
                if (searchTerm) {
                    url += `&title=${encodeURIComponent(searchTerm)}`;
                }
                
                // è·å– token
                const token = localStorage.getItem('token');
                if (!token) {
                    throw new Error('æœªç™»å½•æˆ–ä¼šè¯å·²è¿‡æœŸ');
                }
                
                // è·å–æ€»è®°å½•æ•°
                const countResponse = await fetch(`${API_BASE_URL}/poems?page=1&limit=1`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!countResponse.ok) {
                    throw new Error('è·å–è¯—è¯æ€»æ•°å¤±è´¥');
                }
                
                const countData = await countResponse.json();
                // æ ¹æ®APIè¿”å›æ ¼å¼è·å–æ€»è®°å½•æ•°
                if (countData && countData.length > 0 && countData[0].total_count) {
                    totalPoems = countData[0].total_count;
                } else {
                    // å¦‚æœAPIæ²¡æœ‰è¿”å›æ€»æ•°ï¼Œå…ˆå°è¯•ä»å“åº”å¤´è·å–
                    const totalHeader = countResponse.headers.get('X-Total-Count');
                    if (totalHeader) {
                        totalPoems = parseInt(totalHeader);
                    } else {
                        // å¦‚æœéƒ½æ²¡æœ‰ï¼Œåˆ™è¿›è¡Œä¸€æ¬¡ä¸åˆ†é¡µçš„æŸ¥è¯¢æ¥ä¼°ç®—æ€»æ•°
                        const allResponse = await fetch(`${API_BASE_URL}/poems?limit=2500`, {
                            headers: {
                                'Authorization': `Bearer ${token}`
                            }
                        });
                        if (allResponse.ok) {
                            const allData = await allResponse.json();
                            totalPoems = allData.length;
                        } else {
                            totalPoems = 100; // é»˜è®¤å€¼
                        }
                    }
                }
                
                totalPages = Math.ceil(totalPoems / pageSize);
                console.log(`æ€»è®°å½•æ•°: ${totalPoems}, æ€»é¡µæ•°: ${totalPages}`);
                
                // å‘é€è¯·æ±‚è·å–å½“å‰é¡µæ•°æ®
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error('è·å–è¯—è¯æ•°æ®å¤±è´¥');
                }
                
                const poems = await response.json();
                
                // æ›´æ–°åˆ†é¡µä¿¡æ¯
                updatePagination();
                
                // æ¸…ç©ºè¯—è¯åˆ—è¡¨
                poemsListElem.innerHTML = '';
                
                // å¦‚æœæ²¡æœ‰è¯—è¯æ•°æ®
                if (poems.length === 0) {
                    poemsListElem.innerHTML = '<tr><td colspan="7" style="text-align: center;">æš‚æ— è¯—è¯æ•°æ®</td></tr>';
                    return;
                }
                
                // å¡«å……è¯—è¯æ•°æ®
                poems.forEach(poem => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${poem.id}</td>
                        <td>${poem.title || ''}</td>
                        <td>${poem.author || ''}</td>
                        <td>${poem.dynasty || ''}</td>
                        <td>${poem.category || ''}</td>
                        <td>${poem.theme || ''}</td>
                        <td>
                            <button class="action-btn edit-btn" data-id="${poem.id}">ç¼–è¾‘</button>
                            <button class="action-btn delete-btn" data-id="${poem.id}">åˆ é™¤</button>
                        </td>
                    `;
                    poemsListElem.appendChild(row);
                });
                
                // ç»‘å®šç¼–è¾‘å’Œåˆ é™¤æŒ‰é’®äº‹ä»¶
                bindPoemActions();
            } catch (error) {
                console.error('åŠ è½½è¯—è¯å¤±è´¥:', error);
                poemsListElem.innerHTML = `<tr><td colspan="7" style="text-align: center;">åŠ è½½å¤±è´¥: ${error.message}</td></tr>`;
            }
        }
        
        // æ›´æ–°åˆ†é¡µä¿¡æ¯
        function updatePagination() {
            const pageInfo = document.getElementById('page-info');
            pageInfo.textContent = `ç¬¬ ${currentPage} é¡µ / å…± ${totalPages} é¡µ (å…±${totalPoems}é¦–è¯—è¯)`;
            
            // æ›´æ–°åˆ†é¡µæŒ‰é’®çŠ¶æ€
            document.getElementById('prev-page').disabled = currentPage <= 1;
            document.getElementById('next-page').disabled = currentPage >= totalPages;
            
            // æ›´æ–°è¯—è¯è®¡æ•°
            document.getElementById('total-poems-count').textContent = totalPoems;
        }
        
        // åˆ‡æ¢é¡µç 
        function changePage(delta) {
            const newPage = currentPage + delta;
            if (newPage < 1) return;
            
            const totalPages = Math.ceil(totalPoems / pageSize);
            if (newPage > totalPages) return;
            
            currentPage = newPage;
            loadPoems(document.getElementById('poem-search').value);
        }
        
        // æœç´¢è¯—è¯
        function searchPoems() {
            const searchTerm = document.getElementById('poem-search').value;
            currentPage = 1; // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
            loadPoems(searchTerm);
        }
        
        // ç»‘å®šè¯—è¯æ“ä½œæŒ‰é’®äº‹ä»¶
        function bindPoemActions() {
            // ç»‘å®šç¼–è¾‘æŒ‰é’®
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const poemId = this.getAttribute('data-id');
                    editPoem(poemId);
                });
            });
            
            // ç»‘å®šåˆ é™¤æŒ‰é’®
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const poemId = this.getAttribute('data-id');
                    deletePoem(poemId);
                });
            });
        }
        
        // ç¼–è¾‘è¯—è¯
        async function editPoem(poemId) {
            try {
                // è·å– token
                const token = localStorage.getItem('token');
                if (!token) {
                    throw new Error('æœªç™»å½•æˆ–ä¼šè¯å·²è¿‡æœŸ');
                }
                
                // å‘é€è¯·æ±‚è·å–è¯—è¯è¯¦æƒ…
                const response = await fetch(`${API_BASE_URL}/poems/${poemId}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error('è·å–è¯—è¯è¯¦æƒ…å¤±è´¥');
                }
                
                const data = await response.json();
                const poem = data.data || data;
                
                // å¡«å……è¡¨å•æ•°æ®
                document.getElementById('poem-id').value = poem.id;
                document.getElementById('title').value = poem.title || '';
                document.getElementById('author').value = poem.author || '';
                document.getElementById('dynasty').value = poem.dynasty || 'å”';
                document.getElementById('content').value = poem.content || '';
                document.getElementById('category').value = poem.category || 'å…¶ä»–';
                document.getElementById('theme').value = poem.theme || '';
                document.getElementById('tags').value = poem.tags ? poem.tags.join(',') : '';
                
                // æ›´æ–°è¡¨å•æ ‡é¢˜
                document.getElementById('poem-form-title').textContent = 'ç¼–è¾‘è¯—è¯';
                
                // è¿›å…¥ç¼–è¾‘æ¨¡å¼
                editMode = true;
                
                // æ»šåŠ¨åˆ°è¡¨å•ä½ç½®
                document.getElementById('poem-form').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('ç¼–è¾‘è¯—è¯å¤±è´¥:', error);
                alert(`ç¼–è¾‘è¯—è¯å¤±è´¥: ${error.message}`);
            }
        }
        
        // åˆ é™¤è¯—è¯
        async function deletePoem(poemId) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¯¥è¯—è¯å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                return;
            }
            
            try {
                // è·å– token
                const token = localStorage.getItem('token');
                if (!token) {
                    throw new Error('æœªç™»å½•æˆ–ä¼šè¯å·²è¿‡æœŸ');
                }
                
                // å‘é€åˆ é™¤è¯·æ±‚
                const response = await fetch(`${API_BASE_URL}/poems/${poemId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error('åˆ é™¤è¯—è¯å¤±è´¥');
                }
                
                alert('åˆ é™¤è¯—è¯æˆåŠŸ');
                
                // é‡æ–°åŠ è½½è¯—è¯åˆ—è¡¨
                loadPoems();
            } catch (error) {
                console.error('åˆ é™¤è¯—è¯å¤±è´¥:', error);
                alert(`åˆ é™¤è¯—è¯å¤±è´¥: ${error.message}`);
            }
        }
        
        // æ˜¾ç¤ºæ·»åŠ è¯—è¯è¡¨å•
        function showAddPoemForm() {
            // é‡ç½®è¡¨å•
            resetPoemForm();
            
            // æ›´æ–°è¡¨å•æ ‡é¢˜
            document.getElementById('poem-form-title').textContent = 'æ·»åŠ è¯—è¯';
            
            // æ»šåŠ¨åˆ°è¡¨å•ä½ç½®
            document.getElementById('poem-form').scrollIntoView({ behavior: 'smooth' });
        }
        
        // é‡ç½®è¯—è¯è¡¨å•
        function resetPoemForm() {
            document.getElementById('poem-form').reset();
            document.getElementById('poem-id').value = '';
            document.getElementById('poem-form-title').textContent = 'æ·»åŠ è¯—è¯';
            editMode = false;
        }
        
        // ä¿å­˜è¯—è¯æ•°æ®
        async function savePoemData(event) {
            event.preventDefault();
            
            try {
                // è·å–è¡¨å•æ•°æ®
                const poemId = document.getElementById('poem-id').value;
                const title = document.getElementById('title').value;
                const author = document.getElementById('author').value;
                const dynasty = document.getElementById('dynasty').value;
                const content = document.getElementById('content').value;
                const category = document.getElementById('category').value;
                const theme = document.getElementById('theme').value;
                const tagsString = document.getElementById('tags').value;
                const tags = tagsString ? tagsString.split(',').map(tag => tag.trim()) : [];
                
                // éªŒè¯å¿…å¡«å­—æ®µ
                if (!title || !author || !dynasty || !content) {
                    alert('è¯·å¡«å†™å¿…å¡«å­—æ®µï¼šæ ‡é¢˜ã€ä½œè€…ã€æœä»£å’Œå†…å®¹');
                    return;
                }
                
                // è·å– token
                const token = localStorage.getItem('token');
                if (!token) {
                    throw new Error('æœªç™»å½•æˆ–ä¼šè¯å·²è¿‡æœŸ');
                }
                
                // å‡†å¤‡è¯·æ±‚æ•°æ®
                const requestData = {
                    title,
                    author,
                    dynasty,
                    content,
                    category,
                    theme,
                    tags
                };
                
                let url = `${API_BASE_URL}/poems`;
                let method = 'POST';
                
                // å¦‚æœæ˜¯ç¼–è¾‘æ¨¡å¼
                if (editMode && poemId) {
                    url = `${API_BASE_URL}/poems/${poemId}`;
                    method = 'PUT';
                }
                
                // å‘é€è¯·æ±‚
                const response = await fetch(url, {
                    method,
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(requestData)
                });
                
                if (!response.ok) {
                    throw new Error(`${editMode ? 'æ›´æ–°' : 'æ·»åŠ '}è¯—è¯å¤±è´¥`);
                }
                
                alert(`${editMode ? 'æ›´æ–°' : 'æ·»åŠ '}è¯—è¯æˆåŠŸ`);
                
                // é‡ç½®è¡¨å•
                resetPoemForm();
                
                // é‡æ–°åŠ è½½è¯—è¯åˆ—è¡¨
                loadPoems();
            } catch (error) {
                console.error('ä¿å­˜è¯—è¯å¤±è´¥:', error);
                alert(`ä¿å­˜è¯—è¯å¤±è´¥: ${error.message}`);
            }
        }
        
        // é˜²æŠ–å‡½æ•°
        function debounce(func, delay) {
            let timeout;
            return function() {
                const context = this;
                const args = arguments;
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(context, args), delay);
            };
        }

        // åˆå§‹åŒ–èœå•åˆ‡æ¢åŠŸèƒ½
        function initMenuToggle() {
            // è·å–ç”¨æˆ·ä¿¡æ¯
            const userData = JSON.parse(localStorage.getItem('user')) || {};
            if (userData.username) {
                document.getElementById('admin-name').textContent = userData.username;
            }
            
            // éªŒè¯æ˜¯å¦æ˜¯ç®¡ç†å‘˜
            checkAdminAuth();
            
            // èœå•åˆ‡æ¢åŠŸèƒ½
            const menuItems = document.querySelectorAll('.menu-item');
            const pageContents = document.querySelectorAll('.page-content');
            const pageTitle = document.getElementById('page-title');
            
            menuItems.forEach(item => {
                if (!item.id || item.id !== 'logoutBtn') {
                    item.addEventListener('click', function() {
                        // æ›´æ–°æ´»åŠ¨èœå•é¡¹
                        menuItems.forEach(mi => mi.classList.remove('active'));
                        this.classList.add('active');
                        
                        // æ›´æ–°é¡µé¢æ ‡é¢˜
                        pageTitle.textContent = this.textContent.trim();
                        
                        // æ˜¾ç¤ºå¯¹åº”å†…å®¹åŒºåŸŸ
                        const targetPage = this.getAttribute('data-page');
                        pageContents.forEach(page => {
                            page.classList.remove('active');
                            if (page.id === `${targetPage}-page`) {
                                page.classList.add('active');
                                
                                // å¦‚æœåˆ‡æ¢åˆ°è¯—è¯ç®¡ç†é¡µé¢ï¼Œé‡æ–°åŠ è½½è¯—è¯æ•°æ®
                                if (targetPage === 'poems') {
                                    loadPoems();
                                }
                            }
                        });
                    });
                }
            });
            
            // ä¸ºåˆ†ç±»å¡ç‰‡æ·»åŠ ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.add-card').forEach(card => {
                card.addEventListener('click', function() {
                    document.getElementById('category-form').reset();
                    document.getElementById('category-name').focus();
                });
            });
            
            // ä¸ºå¯¼å…¥å¡ç‰‡æ·»åŠ ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.import-card button').forEach(button => {
                button.addEventListener('click', function() {
                    alert('æ­¤åŠŸèƒ½å°†æ‰“å¼€æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼Œé€‰æ‹©æ•°æ®æ–‡ä»¶è¿›è¡Œå¯¼å…¥ã€‚');
                });
            });
            
            // ä¸ºæ¨¡æ¿ä¸‹è½½æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.template-item button').forEach(button => {
                button.addEventListener('click', function() {
                    const templateName = this.parentElement.querySelector('.template-name').textContent;
                    alert(`å°†ä¸‹è½½${templateName}ï¼Œå®é™…åº”ç”¨ä¸­ä¼šè§¦å‘æ–‡ä»¶ä¸‹è½½ã€‚`);
                });
            });
            
            // æ‰¹é‡æ ‡ç­¾è¡¨å•æäº¤
            document.getElementById('batch-tag-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                alert('æ‰¹é‡æ ‡ç­¾æ“ä½œæäº¤æˆåŠŸï¼');
            });
        }
        
        // éªŒè¯ç®¡ç†å‘˜æƒé™
        function checkAdminAuth() {
            const token = localStorage.getItem('token');
            const user = JSON.parse(localStorage.getItem('user')) || {};
            
            if (!token || user.userType !== 'admin') {
                alert('æ‚¨æ²¡æœ‰ç®¡ç†å‘˜æƒé™ï¼Œå°†è¿”å›ç™»å½•é¡µé¢');
                window.location.href = './ç™»å½•.html';
            }
        }
    </script>
</body>

</html> 